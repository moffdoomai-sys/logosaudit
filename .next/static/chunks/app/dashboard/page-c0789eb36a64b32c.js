(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{9923:function(e,t,r){Promise.resolve().then(r.bind(r,2e3))},2e3:function(e,t,r){"use strict";r.d(t,{default:function(){return R}});var a=r(7437),s=r(2265),n=r(9376),i=r(6070),l=r(2869),d=r(5974),c=r(2759),o=r(4508);let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,o.cn)("w-full caption-bottom text-sm",r),...s})})});u.displayName="Table";let f=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("thead",{ref:t,className:(0,o.cn)("[&_tr]:border-b",r),...s})});f.displayName="TableHeader";let m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,o.cn)("[&_tr:last-child]:border-0",r),...s})});m.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,o.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})}).displayName="TableFooter";let x=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tr",{ref:t,className:(0,o.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});x.displayName="TableRow";let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("th",{ref:t,className:(0,o.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});h.displayName="TableHead";let j=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("td",{ref:t,className:(0,o.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});j.displayName="TableCell",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("caption",{ref:t,className:(0,o.cn)("mt-4 text-sm text-muted-foreground",r),...s})}).displayName="TableCaption";var p=r(5302),g=r(4401),N=r(2489),v=r(1723),y=r(8736),b=r(525),w=r(9397),C=r(3276),E=r(2208),S=r(941),A=r(4506);function R(){let e=(0,n.useRouter)(),{getAllAudits:t,updateAudit:r,deleteAudit:o,isLoadingAudits:R}=(0,S.V)(),[k,O]=(0,s.useState)([]),[T,F]=(0,s.useState)({totalAudits:0,activeAudits:0,completedAudits:0,averageScore:0});(0,s.useEffect)(()=>{P()},[]);let P=async()=>{try{let e=await t();O(e);let r=e.length,a=e.filter(e=>"IN_PROGRESS"===e.status).length,s=e.filter(e=>"COMPLETED"===e.status).length,n=e.filter(e=>"COMPLETED"===e.status&&e.overallScore),i=n.length>0?n.reduce((e,t)=>e+(t.overallScore||0),0)/n.length:0;F({totalAudits:r,activeAudits:a,completedAudits:s,averageScore:i})}catch(e){console.error("Failed to load audits:",e)}},_=t=>{e.push("/audit-execution/".concat(t))},z=t=>{e.push("/audit-view/".concat(t))},L=async e=>{if(confirm("Are you sure you want to cancel this audit?"))try{await r(e,{status:"CANCELLED"}),await P()}catch(e){console.error("Failed to cancel audit:",e)}},D=e=>{switch(e){case"COMPLETED":return"default";case"IN_PROGRESS":return"secondary";case"CANCELLED":return"destructive";default:return"outline"}},I=e=>{switch(e){case"COMPLETED":return(0,a.jsx)(p.Z,{className:"h-4 w-4"});case"IN_PROGRESS":return(0,a.jsx)(g.Z,{className:"h-4 w-4"});case"CANCELLED":return(0,a.jsx)(N.Z,{className:"h-4 w-4"});default:return(0,a.jsx)(v.Z,{className:"h-4 w-4"})}};return R?(0,a.jsx)(Z,{}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"Total Audits"}),(0,a.jsx)(y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:T.totalAudits})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"Active Audits"}),(0,a.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:T.activeAudits})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"Completed"}),(0,a.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:T.completedAudits})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"Average Score"}),(0,a.jsx)(b.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:T.averageScore>0?"".concat(T.averageScore.toFixed(1),"%"):"N/A"})})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(i.ll,{children:"All Audits"}),(0,a.jsx)(i.SZ,{children:"Manage and track your audit activities"})]}),(0,a.jsxs)(l.z,{onClick:()=>e.push("/new-audit"),className:"gap-2",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4"}),"New Audit"]})]}),(0,a.jsx)(i.aY,{children:0===k.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(y.Z,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No audits yet"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Create your first audit to get started"}),(0,a.jsxs)(l.z,{onClick:()=>e.push("/new-audit"),className:"gap-2",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4"}),"Create First Audit"]})]}):(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(u,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(x,{children:[(0,a.jsx)(h,{children:"Title"}),(0,a.jsx)(h,{children:"Company"}),(0,a.jsx)(h,{children:"Lead Auditor"}),(0,a.jsx)(h,{children:"Status"}),(0,a.jsx)(h,{children:"Progress"}),(0,a.jsx)(h,{children:"Started"}),(0,a.jsx)(h,{children:"Actions"})]})}),(0,a.jsx)(m,{children:k.map(e=>{var t;return(0,a.jsxs)(x,{children:[(0,a.jsx)(j,{className:"font-medium",children:e.title}),(0,a.jsx)(j,{children:e.companyName}),(0,a.jsx)(j,{children:null===(t=e.leadAuditor)||void 0===t?void 0:t.name}),(0,a.jsx)(j,{children:(0,a.jsxs)(d.C,{variant:D(e.status),className:"gap-1",children:[I(e.status),e.status.replace("_"," ")]})}),(0,a.jsx)(j,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.E,{value:e.completionPercentage,className:"w-16"}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[e.completionPercentage.toFixed(0),"%"]})]})}),(0,a.jsx)(j,{children:(0,A.Z)("string"==typeof e.dateStarted?new Date(e.dateStarted):e.dateStarted,{addSuffix:!0})}),(0,a.jsx)(j,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:["IN_PROGRESS"===e.status&&(0,a.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>_(e.id),className:"gap-1",children:[(0,a.jsx)(C.Z,{className:"h-3 w-3"}),"Continue"]}),(0,a.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>z(e.id),className:"gap-1",children:[(0,a.jsx)(E.Z,{className:"h-3 w-3"}),"View"]}),"IN_PROGRESS"===e.status&&(0,a.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>L(e.id),className:"gap-1 text-destructive hover:text-destructive",children:[(0,a.jsx)(N.Z,{className:"h-3 w-3"}),"Cancel"]})]})})]},e.id)})})]})})})]})})]})}function Z(){return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:Array.from({length:4}).map((e,t)=>(0,a.jsx)("div",{className:"h-32 bg-muted rounded-lg animate-pulse"},t))}),(0,a.jsx)("div",{className:"h-96 bg-muted rounded-lg animate-pulse"})]})}},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var a=r(7437);r(2265);var s=r(7712),n=r(4508);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:r}),t),...s})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var a=r(7437),s=r(2265),n=r(7053),i=r(7712),l=r(4508);let d=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:c=!1,...o}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(d({variant:s,size:i,className:r})),ref:t,...o})});c.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},ll:function(){return d}});var a=r(7437),s=r(2265),n=r(4508);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});i.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});l.displayName="CardHeader";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});d.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});o.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},2759:function(e,t,r){"use strict";r.d(t,{E:function(){return l}});var a=r(7437),s=r(2265),n=r(610),i=r(4508);let l=s.forwardRef((e,t)=>{let{className:r,value:s,...l}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...l,children:(0,a.jsx)(n.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});l.displayName=n.fC.displayName},941:function(e,t,r){"use strict";r.d(t,{V:function(){return n}});var a=r(2265),s=r(9376);function n(){let[e,t]=(0,a.useState)(!1),[r,n]=(0,a.useState)(!1);return(0,s.useRouter)(),{createAudit:async e=>{t(!0);try{let t=await fetch("/api/audits",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to create audit")}return await t.json()}catch(e){throw console.error("Failed to create audit:",e),e}finally{t(!1)}},getAllAudits:async()=>{n(!0);try{let e=await fetch("/api/audits");if(!e.ok)throw Error("Failed to fetch audits");return await e.json()}catch(e){throw console.error("Failed to fetch audits:",e),e}finally{n(!1)}},getAuditById:async e=>{try{let t=await fetch("/api/audits/".concat(e));if(!t.ok){if(404===t.status)return null;throw Error("Failed to fetch audit")}return await t.json()}catch(e){throw console.error("Failed to fetch audit:",e),e}},updateAudit:async(e,t)=>{try{let r=await fetch("/api/audits/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to update audit");return await r.json()}catch(e){throw console.error("Failed to update audit:",e),e}},deleteAudit:async e=>{try{if(!(await fetch("/api/audits/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete audit")}catch(e){throw console.error("Failed to delete audit:",e),e}},saveFinding:async(e,t)=>{try{if(!(await fetch("/api/audits/".concat(e,"/findings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to save finding")}catch(e){throw console.error("Failed to save finding:",e),e}},isCreatingAudit:e,isLoadingAudits:r}}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var a=r(1994),s=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}}},function(e){e.O(0,[317,750,971,117,744],function(){return e(e.s=9923)}),_N_E=e.O()}]);