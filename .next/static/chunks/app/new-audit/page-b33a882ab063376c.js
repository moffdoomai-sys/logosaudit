(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[751],{3452:function(e,t,s){Promise.resolve().then(s.bind(s,689))},689:function(e,t,s){"use strict";s.d(t,{default:function(){return z}});var a=s(7437),r=s(2265),n=s(9376),i=s(6070),d=s(2869),l=s(5186),c=s(6815),o=s(6818),u=s(2759),m=s(5974),x=s(44),p=s(2369),h=s(5805),f=s(8728),g=s(7689),j=s(5302),v=s(2451),y=s(407),N=s(9397),b=s(2489),w=s(941),S=s(6632),A=s(5153),C=s(5613),D=s(8736),E=s(3113),I=s(804),F=s(2252);let T={"application/pdf":".pdf","text/plain":".txt","image/jpeg":".jpg,.jpeg","image/png":".png","image/gif":".gif"},k={"application/pdf":D.Z,"text/plain":D.Z,"image/jpeg":E.Z,"image/png":E.Z,"image/gif":E.Z};function O(e){let{auditId:t,isoStandard:s,uploadedBy:n,onUploadComplete:l,onUploadStart:c}=e,[o,x]=(0,r.useState)(!1),[p,h]=(0,r.useState)([]),[f,v]=(0,r.useState)([]),[y,N]=(0,r.useState)(null),w=(0,r.useRef)(null),{uploadDocument:S,isUploading:D}=function(){let[e,t]=(0,r.useState)(!1),[s,a]=(0,r.useState)(!1);return{uploadDocument:async(e,s,a,r)=>{t(!0);try{let t=new FormData;t.append("file",e),t.append("auditId",s),t.append("uploadedBy",a),t.append("isoStandard",r);let n=await fetch("/api/documents/upload",{method:"POST",body:t});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to upload document")}return await n.json()}catch(e){throw console.error("Failed to upload document:",e),e}finally{t(!1)}},getDocumentsByAudit:async e=>{a(!0);try{let t=await fetch("/api/documents/".concat(e));if(!t.ok)throw Error("Failed to fetch documents");return await t.json()}catch(e){throw console.error("Failed to fetch documents:",e),e}finally{a(!1)}},deleteDocument:async(e,t)=>{try{if(!(await fetch("/api/documents/".concat(e,"/").concat(t),{method:"DELETE"})).ok)throw Error("Failed to delete document")}catch(e){throw console.error("Failed to delete document:",e),e}},getDocumentById:async(e,t)=>{try{let s=await fetch("/api/documents/".concat(e,"/").concat(t));if(!s.ok){if(404===s.status)return null;throw Error("Failed to fetch document")}return await s.json()}catch(e){throw console.error("Failed to fetch document:",e),e}},isUploading:e,isLoadingDocuments:s}}(),{toast:E}=(0,A.pm)(),O=e=>Object.keys(T).includes(e.type)?e.size>10485760?"File size too large: ".concat((e.size/1048576).toFixed(1),"MB. Maximum size is 10MB."):null:"Unsupported file type: ".concat(e.type,". Please upload PDF, text, or image files."),Z=e=>{if(!e)return;let t=[],s=[];if(Array.from(e).forEach(e=>{let a=O(e);a?s.push("".concat(e.name,": ").concat(a)):t.push(e)}),s.length>0){N(s.join("\n"));return}N(null),h(e=>[...e,...t])},z=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?x(!0):"dragleave"===e.type&&x(!1)},M=e=>{h(t=>t.filter((t,s)=>s!==e))},P=async()=>{if(0!==p.length){N(null),null==c||c();try{let e=p.map(e=>S(e,t,n,s)),a=await Promise.all(e);v(e=>[...e,...a]),h([]),a.forEach(e=>{null==l||l(e)}),E({title:"Documents uploaded successfully",description:"".concat(a.length," document(s) uploaded and queued for analysis.")})}catch(e){console.error("Upload failed:",e),N(e instanceof Error?e.message:"Upload failed"),E({title:"Upload failed",description:"There was an error uploading your documents. Please try again.",variant:"destructive"})}}},R=e=>{let t=k[e.type]||I.Z;return(0,a.jsx)(t,{className:"h-4 w-4"})},_=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return(0,a.jsxs)(i.Zb,{className:"w-full",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5"}),"Document Upload"]}),(0,a.jsx)(i.SZ,{children:"Upload relevant documents for AI-powered analysis and ISO clause matching. Supported formats: PDF, Text, and Images (max 10MB each)."})]}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[y&&(0,a.jsxs)(C.bZ,{variant:"destructive",children:[(0,a.jsx)(F.Z,{className:"h-4 w-4"}),(0,a.jsx)(C.X,{className:"whitespace-pre-line",children:y})]}),(0,a.jsxs)("div",{className:"\n            border-2 border-dashed rounded-lg p-6 text-center transition-colors cursor-pointer\n            ".concat(o?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50","\n          "),onDragEnter:z,onDragLeave:z,onDragOver:z,onDrop:e=>{e.preventDefault(),e.stopPropagation(),x(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&Z(e.dataTransfer.files)},onClick:()=>{var e;return null===(e=w.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)(g.Z,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Drag & drop files here, or click to browse"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"PDF, TXT, JPG, PNG, GIF (max 10MB each)"})]}),(0,a.jsx)("input",{ref:w,type:"file",multiple:!0,accept:Object.values(T).join(","),onChange:e=>{Z(e.target.files)},className:"hidden"}),p.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Selected Files"}),p.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[R(e),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:_(e.size)})]})]}),(0,a.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>M(t),disabled:D,children:(0,a.jsx)(b.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsx)(d.z,{onClick:P,disabled:D||0===p.length,className:"w-full",children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Upload ",p.length," File(s)"]})})]}),D&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex items-center justify-between text-sm",children:(0,a.jsx)("span",{children:"Uploading documents..."})}),(0,a.jsx)(u.E,{value:void 0,className:"w-full"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Documents will be analyzed in the background after upload."})]}),f.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Recently Uploaded"}),f.map(e=>(0,a.jsx)("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-green-50/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.originalName}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(m.C,{variant:"outline",className:"text-xs",children:["PENDING"===e.analysisStatus&&"Queued for Analysis","PROCESSING"===e.analysisStatus&&"Analyzing...","COMPLETED"===e.analysisStatus&&"Analysis Complete","FAILED"===e.analysisStatus&&"Analysis Failed"]})})]})]})},e.id))]})]})]})}let Z=[{id:1,title:"Audit Details",icon:x.Z},{id:2,title:"Lead Auditor",icon:p.Z},{id:3,title:"Interviewees",icon:h.Z},{id:4,title:"Scope Selection",icon:f.Z},{id:5,title:"Document Upload",icon:g.Z},{id:6,title:"Review & Create",icon:j.Z}];function z(){var e;let t=(0,n.useRouter)(),{createAudit:s,isCreatingAudit:l}=(0,w.V)(),{toast:c}=(0,A.pm)(),[o,m]=(0,r.useState)(1),[x,p]=(0,r.useState)({title:"",companyName:"",companyAddress:"",leadAuditorName:"",leadAuditorEmail:"",leadAuditorTitle:"",isoStandard:"ISO9001",interviewees:[],selectedSections:[],customScope:!1,uploadedDocuments:[]}),[h,f]=(0,r.useState)(null),g=e=>{p(t=>({...t,...e}))},N=e=>{switch(e){case 1:return!!(x.title&&x.companyName&&x.companyAddress);case 2:return!!(x.leadAuditorName&&x.leadAuditorEmail);case 3:case 5:case 6:return!0;case 4:return x.selectedSections.length>0;default:return!1}},b=async()=>{if(N(o)){if(4===o&&!h)try{let e=await s(x);if(e)f(e.id),c({title:"Audit Created",description:"Your audit has been created. You can now upload documents."});else{c({title:"Error",description:"Failed to create audit. Please try again.",variant:"destructive"});return}}catch(e){c({title:"Error",description:"Failed to create audit. Please try again.",variant:"destructive"});return}o<Z.length&&m(e=>e+1)}},S=async()=>{if(!h){c({title:"Error",description:"Audit was not properly created. Please go back and try again.",variant:"destructive"});return}c({title:"Audit Setup Complete",description:"Your audit has been created and is ready for execution."}),t.push("/audit-execution/".concat(h))},C=e=>{g({uploadedDocuments:[...x.uploadedDocuments||[],e]})},D=o/Z.length*100;return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,a.jsx)(i.Zb,{children:(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)(i.ll,{children:["Step ",o," of ",Z.length]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[Math.round(D),"% Complete"]})]}),(0,a.jsx)(u.E,{value:D,className:"mb-4"}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:Z.map(e=>{let t=e.icon;return(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,a.jsx)("div",{className:"\n                    flex items-center justify-center w-8 h-8 rounded-full border-2 \n                    ".concat(o>=e.id?"bg-primary border-primary text-primary-foreground":"border-muted-foreground text-muted-foreground","\n                  "),children:(0,a.jsx)(t,{className:"h-4 w-4"})}),(0,a.jsx)("span",{className:"text-xs ".concat(o>=e.id?"text-primary":"text-muted-foreground"),children:e.title})]},e.id)})})]})}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:null===(e=Z[o-1])||void 0===e?void 0:e.title})}),(0,a.jsx)(i.aY,{children:(()=>{switch(o){case 1:return(0,a.jsx)(P,{formData:x,updateFormData:g});case 2:return(0,a.jsx)(R,{formData:x,updateFormData:g});case 3:return(0,a.jsx)(_,{formData:x,updateFormData:g});case 4:return(0,a.jsx)(B,{formData:x,updateFormData:g});case 5:return(0,a.jsx)(M,{auditId:h,isoStandard:x.isoStandard,uploadedBy:"current-user",onDocumentUpload:C,uploadedDocuments:x.uploadedDocuments||[]});case 6:return(0,a.jsx)(L,{formData:x,createdAuditId:h});default:return null}})()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(d.z,{variant:"outline",onClick:()=>{o>1&&m(e=>e-1)},disabled:1===o,className:"gap-2",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4"}),"Previous"]}),o<Z.length?(0,a.jsxs)(d.z,{onClick:b,disabled:!N(o)||4===o&&l,className:"gap-2",children:[4===o&&l?"Creating Audit...":"Next",(0,a.jsx)(y.Z,{className:"h-4 w-4"})]}):(0,a.jsxs)(d.z,{onClick:S,disabled:!h,className:"gap-2",children:["Complete Setup",(0,a.jsx)(j.Z,{className:"h-4 w-4"})]})]})]})}function M(e){let{auditId:t,isoStandard:s,uploadedBy:r,onDocumentUpload:n,uploadedDocuments:i}=e;return t?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Upload Supporting Documents"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Upload relevant documents that will be analyzed using AI to match with ISO clauses. This step is optional but will enhance your audit with intelligent document references."})]}),(0,a.jsx)(O,{auditId:t,isoStandard:s,uploadedBy:r,onUploadComplete:n}),i.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Uploaded Documents"}),(0,a.jsx)("div",{className:"grid gap-2",children:i.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-green-50/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.originalName})]}),(0,a.jsxs)(m.C,{variant:"outline",className:"text-xs",children:["PENDING"===e.analysisStatus&&"Queued","PROCESSING"===e.analysisStatus&&"Analyzing","COMPLETED"===e.analysisStatus&&"Complete","FAILED"===e.analysisStatus&&"Failed"]})]},e.id))})]})]}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Audit must be created before uploading documents."})})}function P(e){let{formData:t,updateFormData:s}=e;return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"title",children:"Audit Title *"}),(0,a.jsx)(l.I,{id:"title",value:t.title,onChange:e=>s({title:e.target.value}),placeholder:"e.g., Annual ISO 9001 Compliance Audit"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"companyName",children:"Company Name *"}),(0,a.jsx)(l.I,{id:"companyName",value:t.companyName,onChange:e=>s({companyName:e.target.value}),placeholder:"e.g., ABC Manufacturing Ltd."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"companyAddress",children:"Company Address *"}),(0,a.jsx)(o.g,{id:"companyAddress",value:t.companyAddress,onChange:e=>s({companyAddress:e.target.value}),placeholder:"Full company address including city, state, and postal code",rows:3})]})]})})}function R(e){let{formData:t,updateFormData:s}=e;return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"leadAuditorName",children:"Lead Auditor Name *"}),(0,a.jsx)(l.I,{id:"leadAuditorName",value:t.leadAuditorName,onChange:e=>s({leadAuditorName:e.target.value}),placeholder:"Full name of the lead auditor"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"leadAuditorEmail",children:"Email Address *"}),(0,a.jsx)(l.I,{id:"leadAuditorEmail",type:"email",value:t.leadAuditorEmail,onChange:e=>s({leadAuditorEmail:e.target.value}),placeholder:"lead.auditor@company.com"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"leadAuditorTitle",children:"Job Title"}),(0,a.jsx)(l.I,{id:"leadAuditorTitle",value:t.leadAuditorTitle,onChange:e=>s({leadAuditorTitle:e.target.value}),placeholder:"e.g., Senior Quality Auditor"})]})]})})}function _(e){let{formData:t,updateFormData:s}=e,r=()=>{s({interviewees:[...t.interviewees,{name:"",jobTitle:"",department:"",email:""}]})},n=e=>{s({interviewees:t.interviewees.filter((t,s)=>s!==e)})},o=(e,a,r)=>{s({interviewees:t.interviewees.map((t,s)=>s===e?{...t,[a]:r}:t)})};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Interviewees"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add key personnel who will be interviewed during the audit"})]}),(0,a.jsxs)(d.z,{onClick:r,variant:"outline",className:"gap-2",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4"}),"Add Interviewee"]})]}),0===t.interviewees.length?(0,a.jsxs)("div",{className:"text-center py-8 border-2 border-dashed border-muted rounded-lg",children:[(0,a.jsx)(h.Z,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No interviewees added yet"}),(0,a.jsxs)(d.z,{onClick:r,variant:"outline",className:"mt-4 gap-2",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4"}),"Add First Interviewee"]})]}):(0,a.jsx)("div",{className:"space-y-4",children:t.interviewees.map((e,t)=>(0,a.jsx)(i.Zb,{children:(0,a.jsxs)(i.aY,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("h4",{className:"font-medium",children:["Interviewee ",t+1]}),(0,a.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>n(t),className:"text-destructive hover:text-destructive",children:(0,a.jsx)(b.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{children:"Name *"}),(0,a.jsx)(l.I,{value:e.name,onChange:e=>o(t,"name",e.target.value),placeholder:"Full name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{children:"Job Title *"}),(0,a.jsx)(l.I,{value:e.jobTitle,onChange:e=>o(t,"jobTitle",e.target.value),placeholder:"Job title"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{children:"Department"}),(0,a.jsx)(l.I,{value:e.department,onChange:e=>o(t,"department",e.target.value),placeholder:"Department"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{children:"Email"}),(0,a.jsx)(l.I,{type:"email",value:e.email,onChange:e=>o(t,"email",e.target.value),placeholder:"email@company.com"})]})]})]})},t))})]})}function B(e){let{formData:t,updateFormData:s}=e,r=(0,S.$Q)(t.isoStandard),n=(0,S.GG)(t.isoStandard),l=e=>{s({isoStandard:e,selectedSections:[]})},c=e=>{s({selectedSections:t.selectedSections.includes(e)?t.selectedSections.filter(t=>t!==e):[...t.selectedSections,e]})};return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Select ISO Standard"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose the ISO standard for this audit"})]}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:S.zg.map(e=>{let s=t.isoStandard===e.id;return(0,a.jsx)(i.Zb,{className:"cursor-pointer transition-all hover:shadow-md ".concat(s?"ring-2 ring-primary bg-primary/5":""),onClick:()=>l(e.id),children:(0,a.jsxs)(i.aY,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(m.C,{variant:"outline",className:"font-semibold",children:e.name}),(0,a.jsx)(m.C,{variant:"secondary",children:e.version})]}),(0,a.jsx)("h4",{className:"font-medium mb-2",children:e.fullName}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,a.jsx)("div",{className:"w-4 h-4 rounded border-2 flex items-center justify-center ".concat(s?"bg-primary border-primary":"border-muted-foreground"),children:s&&(0,a.jsx)(j.Z,{className:"h-3 w-3 text-primary-foreground"})})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.sections.length," sections • ",e.sections.reduce((e,t)=>e+t.questionCount,0)," total questions"]})]})},e.id)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Select Audit Scope"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Select the ",null==r?void 0:r.name," sections to include in this audit"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>{s({selectedSections:n.map(e=>e.id)})},children:"Select All"}),(0,a.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>{s({selectedSections:[]})},children:"Select None"})]})]}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:n.map(e=>{let s=t.selectedSections.includes(e.id);return(0,a.jsx)(i.Zb,{className:"cursor-pointer transition-all hover:shadow-md ".concat(s?"ring-2 ring-primary bg-primary/5":""),onClick:()=>c(e.id),children:(0,a.jsxs)(i.aY,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(m.C,{variant:"outline",children:e.number}),(0,a.jsx)(m.C,{variant:"critical"===e.riskLevel?"destructive":"secondary",children:e.riskLevel})]}),(0,a.jsx)("h4",{className:"font-medium mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,a.jsx)("div",{className:"w-4 h-4 rounded border-2 flex items-center justify-center ".concat(s?"bg-primary border-primary":"border-muted-foreground"),children:s&&(0,a.jsx)(j.Z,{className:"h-3 w-3 text-primary-foreground"})})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.questionCount," questions • ",e.industryRelevance]})]})},e.id)})}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mt-4",children:["Selected: ",t.selectedSections.length," of ",n.length," sections"]})]})]})}function L(e){var t;let{formData:s,createdAuditId:r}=e,n=(0,S.$Q)(s.isoStandard),d=(0,S.GG)(s.isoStandard),l=d.filter(e=>s.selectedSections.includes(e.id));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Audit Setup Complete"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-6",children:'Your audit has been successfully created. Review the configuration below and click "Complete Setup" to begin the audit execution.'}),r&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-green-700",children:["Audit ID: ",r]})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-base",children:"Audit Details"})}),(0,a.jsxs)(i.aY,{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Title:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.title})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Company:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.companyName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Address:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.companyAddress})]})]})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-base",children:"Lead Auditor"})}),(0,a.jsxs)(i.aY,{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Name:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.leadAuditorName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Email:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.leadAuditorEmail})]}),s.leadAuditorTitle&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Title:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.leadAuditorTitle})]})]})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)(i.ll,{className:"text-base",children:["Interviewees (",s.interviewees.length,")"]})}),(0,a.jsx)(i.aY,{children:0===s.interviewees.length?(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No interviewees added"}):(0,a.jsx)("div",{className:"space-y-2",children:s.interviewees.map((e,t)=>(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[" - ",e.jobTitle]})]},t))})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-base",children:"Audit Scope"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"ISO Standard:"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)(m.C,{variant:"outline",className:"font-semibold",children:null==n?void 0:n.name}),(0,a.jsx)(m.C,{variant:"secondary",children:null==n?void 0:n.version})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Selected Sections:"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:[l.length," of ",d.length," sections selected"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:l.map(e=>(0,a.jsx)(m.C,{variant:"outline",className:"text-xs",children:e.number},e.id))})]})]})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)(i.ll,{className:"text-base",children:["Documents (",(null===(t=s.uploadedDocuments)||void 0===t?void 0:t.length)||0,")"]})}),(0,a.jsx)(i.aY,{children:s.uploadedDocuments&&0!==s.uploadedDocuments.length?(0,a.jsxs)("div",{className:"space-y-2",children:[s.uploadedDocuments.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:e.originalName}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(e.fileSize/1048576).toFixed(1)," MB"]})]}),(0,a.jsxs)(m.C,{variant:"outline",className:"text-xs",children:["PENDING"===e.analysisStatus&&"Queued","PROCESSING"===e.analysisStatus&&"Analyzing","COMPLETED"===e.analysisStatus&&"Complete","FAILED"===e.analysisStatus&&"Failed"]})]},e.id)),(0,a.jsx)("div",{className:"mt-3 p-2 bg-blue-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-xs text-blue-700",children:"\uD83D\uDCC4 Documents will be analyzed to provide intelligent clause references during the audit."})})]}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No documents uploaded"})})]})]})]})}},5613:function(e,t,s){"use strict";s.d(t,{X:function(){return c},bZ:function(){return l}});var a=s(7437),r=s(2265),n=s(7712),i=s(4508);let d=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=r.forwardRef((e,t)=>{let{className:s,variant:r,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(d({variant:r}),s),...n})});l.displayName="Alert",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",s),...r})}).displayName="AlertTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",s),...r})});c.displayName="AlertDescription"},5974:function(e,t,s){"use strict";s.d(t,{C:function(){return d}});var a=s(7437);s(2265);var r=s(7712),n=s(4508);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...r})}},2869:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var a=s(7437),r=s(2265),n=s(7053),i=s(7712),d=s(4508);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:c=!1,...o}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,d.cn)(l({variant:r,size:i,className:s})),ref:t,...o})});c.displayName="Button"},6070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return d},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},ll:function(){return l}});var a=s(7437),r=s(2265),n=s(4508);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});i.displayName="Card";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});d.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});l.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},5186:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var a=s(7437),r=s(2265),n=s(4508);let i=r.forwardRef((e,t)=>{let{className:s,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},6815:function(e,t,s){"use strict";s.d(t,{_:function(){return c}});var a=s(7437),r=s(2265),n=s(6394),i=s(7712),d=s(4508);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,d.cn)(l(),s),...r})});c.displayName=n.f.displayName},2759:function(e,t,s){"use strict";s.d(t,{E:function(){return d}});var a=s(7437),r=s(2265),n=s(610),i=s(4508);let d=r.forwardRef((e,t)=>{let{className:s,value:r,...d}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...d,children:(0,a.jsx)(n.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});d.displayName=n.fC.displayName},6818:function(e,t,s){"use strict";s.d(t,{g:function(){return i}});var a=s(7437),r=s(2265),n=s(4508);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r})});i.displayName="Textarea"},941:function(e,t,s){"use strict";s.d(t,{V:function(){return n}});var a=s(2265),r=s(9376);function n(){let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!1);return(0,r.useRouter)(),{createAudit:async e=>{t(!0);try{let t=await fetch("/api/audits",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to create audit")}return await t.json()}catch(e){throw console.error("Failed to create audit:",e),e}finally{t(!1)}},getAllAudits:async()=>{n(!0);try{let e=await fetch("/api/audits");if(!e.ok)throw Error("Failed to fetch audits");return await e.json()}catch(e){throw console.error("Failed to fetch audits:",e),e}finally{n(!1)}},getAuditById:async e=>{try{let t=await fetch("/api/audits/".concat(e));if(!t.ok){if(404===t.status)return null;throw Error("Failed to fetch audit")}return await t.json()}catch(e){throw console.error("Failed to fetch audit:",e),e}},updateAudit:async(e,t)=>{try{let s=await fetch("/api/audits/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw Error("Failed to update audit");return await s.json()}catch(e){throw console.error("Failed to update audit:",e),e}},deleteAudit:async e=>{try{if(!(await fetch("/api/audits/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete audit")}catch(e){throw console.error("Failed to delete audit:",e),e}},saveFinding:async(e,t)=>{try{if(!(await fetch("/api/audits/".concat(e,"/findings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to save finding")}catch(e){throw console.error("Failed to save finding:",e),e}},isCreatingAudit:e,isLoadingAudits:s}}},5153:function(e,t,s){"use strict";s.d(t,{pm:function(){return m}});var a=s(2265);let r=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},d=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function o(e){c=d(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>o({type:"DISMISS_TOAST",toastId:s});return o({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(c);return a.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},6632:function(e,t,s){"use strict";s.d(t,{$Q:function(){return c},A:function(){return d},GG:function(){return o},ae:function(){return l},uU:function(){return i},zg:function(){return n}});let a=[{id:"brand-identity",title:"Brand Identity",description:"Logo design, color palette, typography",category:"visual",standardId:"iso9001",number:"4",questionCount:12,riskLevel:"high",industryRelevance:"Critical for brand consistency and recognition"},{id:"brand-messaging",title:"Brand Messaging",description:"Voice, tone, key messages",category:"content",standardId:"iso9001",number:"5",questionCount:8,riskLevel:"medium",industryRelevance:"Important for communication effectiveness"},{id:"brand-application",title:"Brand Application",description:"How brand is applied across touchpoints",category:"implementation",standardId:"iso9001",number:"6",questionCount:15,riskLevel:"high",industryRelevance:"Essential for consistent brand experience"}],r=[{id:"iso9001",name:"ISO 9001:2015",description:"Quality Management Systems"},{id:"iso45001",name:"ISO 45001:2018",description:"Occupational Health and Safety Management Systems"},{id:"iso14001",name:"ISO 14001:2015",description:"Environmental Management Systems"}],n=r,i=[{id:"basic-brand-audit",name:"Basic Brand Audit",description:"Comprehensive brand assessment",sections:["brand-identity","brand-messaging","brand-application"],recommendedFor:["Initial brand assessment","Brand consistency evaluation","Marketing alignment review"]},{id:"comprehensive-audit",name:"Comprehensive ISO 9001 Audit",description:"Full system assessment covering all sections",sections:["brand-identity","brand-messaging","brand-application"],recommendedFor:["Annual management review","Certification preparation","Complete system evaluation"]},{id:"leadership-focus",name:"Leadership & Management Focus",description:"Focus on leadership and organizational context",sections:["brand-identity","brand-messaging"],recommendedFor:["Management system maturity assessment","Leadership effectiveness review","Strategic alignment evaluation"]}],d=a,l=e=>a.find(t=>t.id===e),c=e=>r.find(t=>t.id===e),o=e=>a.filter(t=>t.standardId===e)},4508:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(1994),r=s(3335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[317,273,971,117,744],function(){return e(e.s=3452)}),_N_E=e.O()}]);